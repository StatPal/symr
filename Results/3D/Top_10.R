## 3D: 

all_measures_3D_best_test <- 
  cbind(
    matrix(c(0.0779988, 0.0898958, 0.0846591, 0.10012,  0.113806,  0.150059, 0.0936036,  0.108343,  0.153307,
             0.0889124,  0.101731, 0.0960377,  0.109376,  0.12312,  0.162885,   0.10151,   0.115155,  0.158854,
             0.108531, 0.123776,   0.136959,  0.14688,    0.160888, 0.279508, 0.141041,    0.163054,  0.225959,
             0.110101,  0.12524,   0.138678, 0.147657,    0.160966,  0.28012, 0.141681,    0.163053,  0.224378), ncol=4), 
    
    ## AECM
    matrix(c(0.0775958,  0.089745, 0.0840052,  0.100165,  0.113741,  0.149314,  0.0931446, 0.107023,   0.1521,
             0.0885176,  0.101589, 0.0953864,  0.109426,  0.123066,  0.162142,  0.101055,  0.113843,   0.157675,
             0.108001, 0.123598,   0.135821, 0.146979,   0.160705,   0.278,     0.140212,  0.159787,   0.222075,
             0.10959,  0.125078,   0.13756,  0.147766,   0.160803,   0.278617,  0.140864,  0.159798,   0.2205), ncol=4)
  )




best_test_3D <- cbind(
  matrix(c(0.0169789, 0.0779988, 0.0898958, 0.0846591, 0.10012, 0.113806, 0.150059, 0.0936036, 0.0233944, 0.00771449, 0.108343, 0.153307,
    0.0352309, 0.0889124, 0.101731, 0.0960377, 0.109376, 0.12312, 0.162885, 0.10151, 0.0376986, 0.0204762, 0.115155, 0.158854,
    0.0480221, 0.108531, 0.123776, 0.136959, 0.14688, 0.160888, 0.279508, 0.141041, 0.0600443, 0.0170164, 0.163054, 0.225959,
    0.0552097, 0.110101, 0.12524, 0.138678, 0.147657, 0.160966, 0.28012, 0.141681, 0.0627752, 0.0265294, 0.163053, 0.224378), ncol=4)
  ,
  matrix(c(0.0169628, 0.0779832, 0.089943, 0.0846261, 0.10013, 0.113988, 0.149443, 0.0930718, 0.0229823, 0.00890136, 0.107647, 0.152466,
    0.0347746, 0.0888961, 0.101777, 0.0960046, 0.109384, 0.123293, 0.16227, 0.100975, 0.0362448, 0.0214872, 0.114445, 0.157983,
    0.0468778, 0.108564, 0.12393, 0.136629, 0.146975, 0.161221, 0.278157, 0.140182, 0.0537391, 0.0214689, 0.160835, 0.222552,
    0.0542191, 0.110132, 0.125391, 0.138353, 0.147748, 0.161287, 0.278773, 0.140821, 0.0567528, 0.0295839, 0.160817, 0.220921), ncol=4)
  ,
  matrix(c(0.0216114, 0.0788977, 0.0908853, 0.0849266, 0.100851, 0.11448, 0.149421, 0.0931925, 0.0234269, 0.0118523, 0.107612, 0.152672,
    0.0395624, 0.0898138, 0.10272, 0.0963073, 0.110101, 0.123777, 0.162248, 0.101088, 0.0370232, 0.0245213, 0.114405, 0.158206,
    0.050758, 0.109828, 0.125272, 0.137068, 0.148108, 0.16195, 0.278109, 0.140328, 0.0540425, 0.0240404, 0.160681, 0.222965,
    0.0576176, 0.111383, 0.126721, 0.138789, 0.148871, 0.162009, 0.278725, 0.140958, 0.0569885, 0.0314968, 0.160659, 0.221352), ncol=4)
  ,
  matrix(c(0.0203244, 0.0775906, 0.0897386, 0.0840065, 0.100158, 0.113739, 0.149314, 0.0931424, 0.0231737, 0.0114876, 0.107025, 0.1521,
    0.0382823, 0.0885122, 0.101583, 0.0953877, 0.10942, 0.123063, 0.162142, 0.101053, 0.0368684, 0.0241543, 0.113846, 0.157676,
    0.0483771, 0.107994, 0.123588, 0.135822, 0.146968, 0.160701, 0.277999, 0.140208, 0.0538134, 0.0228594, 0.159792, 0.222075,
    0.055538, 0.109582, 0.125069, 0.137561, 0.147755, 0.160798, 0.278616, 0.14086, 0.0568657, 0.0306047, 0.159803,    0.2205), ncol=4)
)


best_test_3D


xtable::xtable(best_test_3D[,13:16], digits=5)





## Okay there is a mistake in SSIM - wo versions of MLE are same
## SSIM_3D.R - code is corrected but not run

top_10_val <- rbind(
  c(0, 8, 9,                                 ## train samples
    0.107977, 0.117509, 0.165177, 0.165764,  ## LS
    0.1077, 0.117225, 0.164338, 0.164916,    ## MLE 26
    0.108181, 0.117702, 0.165011, 0.165577,  ## OSL
    0.107708, 0.11723, 0.164356, 0.164929,   ## MLE 29
    0.107426, 0.116967, 0.163909, 0.164508,  ## AECM
    
    0.981632, 0.982006, 0.981919, 0.982006, 0.982061
  )
  ,
  c(1, 8, 9,
    0.108714, 0.118516, 0.166654, 0.16735, 
    0.108389, 0.118184, 0.165687, 0.166375, 
    0.108886, 0.118666, 0.166639, 0.167282,
    0.1084, 0.118194, 0.165702, 0.166389,
    0.107868, 0.117707, 0.164882, 0.165628,
    
    0.981203, 0.981608, 0.981485, 0.981608, 0.981717
  )
  ,
  c(1, 9, 11, 
    0.109798, 0.119834, 0.169355, 0.170124,
    0.109689, 0.119718, 0.168984, 0.169744,
    0.110321, 0.120313, 0.170309, 0.17098,
    0.10972, 0.119747, 0.16904, 0.169796,
    0.109214, 0.119286, 0.168284, 0.169098,
    
    0.981304, 0.981640, 0.981458, 0.981640, 0.981740
  )
  ,
  c(0, 9, 11, 
    0.110292, 0.120002, 0.169979, 0.170548,
    0.110167, 0.11987, 0.169625, 0.170185,
    0.110821, 0.120518, 0.170793, 0.171318,
    0.110198, 0.119898, 0.169684, 0.170238,
    0.109885, 0.119603, 0.169199, 0.169782,
    
    0.981470, 0.981793, 0.981517, 0.981793, 0.981858
  )
  ,
  c(0, 7, 8,
    0.114759, 0.124753, 0.170151, 0.170938,
    0.11479, 0.124784, 0.170169, 0.170955,
    0.114938, 0.12493, 0.170334, 0.171117,
    0.114787, 0.124782, 0.170164, 0.170951,
    0.112289, 0.122285, 0.166372, 0.167177,
    
    0.981053, 0.981049, 0.981011, 0.981049, 0.981913
  )
  ,
  c(1, 6, 8, 
    0.112626, 0.121727, 0.172369, 0.172858,
    0.111712, 0.120799, 0.170266, 0.170743,
    0.111855, 0.120997, 0.170264, 0.170795,
    0.11171, 0.120797, 0.170251, 0.170727,
    0.109946, 0.119108, 0.167438, 0.168038,
    
    0.978863, 0.979482, 0.979546, 0.979482, 0.979976
  )
  ,
  c(0, 9, 10,
    0.113623, 0.122295, 0.171462, 0.171524,
    0.113326, 0.121995, 0.170796, 0.170854,
    0.113582, 0.122252, 0.171148, 0.171206,
    0.113326, 0.121994, 0.170796, 0.170853,
    0.112919, 0.121601, 0.170201, 0.170275,
    
    0.980474, 0.980821, 0.980790, 0.980821, 0.980924
  )
  ,
  c(0, 6, 8,
    0.112943, 0.122141, 0.172634, 0.173296,
    0.111924, 0.121107, 0.170459, 0.171116,
    0.112726, 0.121833, 0.171296, 0.171857,
    0.111914, 0.121091, 0.170457, 0.171109,
    0.110622, 0.119837, 0.168466, 0.169154,
    
    0.978733, 0.979375, 0.979420, 0.979375, 0.979837
  )
  , 
  c(1, 9, 10,
    0.113766, 0.122884, 0.172386, 0.172618,
    0.113405, 0.122521, 0.171522, 0.171754,
    0.113653, 0.122772, 0.17185, 0.172079,
    0.113398, 0.122514, 0.171494, 0.171727,
    0.112842, 0.121988, 0.170572, 0.170846,
    
    0.980057, 0.980456, 0.980421, 0.980456, 0.980605
  )
  ,
  c(1, 7, 8, 
    0.1162, 0.126487, 0.172201, 0.173193,
    0.116188, 0.126474, 0.172149, 0.17314,
    0.115825, 0.126111, 0.171623, 0.172615,
    0.116188, 0.126475, 0.172152, 0.173143,
    0.114225, 0.124512, 0.169174, 0.170179,
    
    0.980527, 0.980538, 0.980665, 0.980538, 0.981233
  )
)
top_10_val[,1:3] <- top_10_val[,1:3]+1
top_10_val_reserve <- top_10_val


top_10_val <- top_10_val[,c(1:7, 24, 8:11, 25, 12:15, 26, 16:19, 27, 20:23, 28)]


head(top_10_val)
xtable::xtable(t(top_10_val), digits=4)


# (top_10_val <- top_10_val[,-(19:23)])
# xtable::xtable(t(top_10_val), digits=5)



## Averaging: 
top_10_val[,4] <- (top_10_val[,4] + top_10_val[,5])/2
top_10_val[,6] <- (top_10_val[,6] + top_10_val[,7])/2

top_10_val[,9]  <- (top_10_val[,9] + top_10_val[,10])/2
top_10_val[,11] <- (top_10_val[,11] + top_10_val[,12])/2

top_10_val[,14] <- (top_10_val[,14] + top_10_val[,15])/2
top_10_val[,16] <- (top_10_val[,16] + top_10_val[,17])/2

top_10_val[,19] <- (top_10_val[,19] + top_10_val[,20])/2
top_10_val[,21] <- (top_10_val[,21] + top_10_val[,22])/2

top_10_val[,24] <- (top_10_val[,24] + top_10_val[,25])/2
top_10_val[,26] <- (top_10_val[,26] + top_10_val[,27])/2


top_10_val <- top_10_val[,-c(5,7,10,12,15,17,20,22,25,27)]
top_10_val ## RMPSE, MAPE, SSIM for LS, MLE26, OSL, MLE29, AECM


# xtable::xtable(t(top_10_val), digits=4)





top_10_val <- top_10_val[,-c(13:15)]
top_10_val ## RMPSE, MAPE, SSIM for LS, MLE26, OSL, AECM

(save_order <- order(top_10_val[,13]))
top_10_val[save_order,]
xtable::xtable(t(top_10_val[save_order,]), digits=5)





top_10_val <- top_10_val_reserve
top_10_val <- top_10_val[,c(1:7, 24, 8:11, 25, 12:15, 26, 16:19, 27, 20:23, 28)]
top_10_val <- top_10_val[save_order,]
head(top_10_val)
# xtable::xtable(t(top_10_val), digits=4)


(top_10_val <- top_10_val[,-(19:23)])
xtable::xtable(t(top_10_val), digits=5)

